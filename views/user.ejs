<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pet Lovers Blog</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="/styles/main.css" />
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light">
    <div class="container-fluid">
      <a class="navbar-brand" href="/">üêæ Pet Blog</a>
      <div class="nav-buttons">
        <a href="/logout" class="btn btn-custom">Logout</a>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="container mt-5 mb-5">
    <h2 class="mb-4">Welcome, <%= username %>!</h2>

    <div class="row">
      <!-- Left Column: Posts -->
      <div class="col-md-8">
        <!-- Static Post 1 -->
        <div class="card post-card p-3 mb-4">
          <img src="dog-img.jpg" class="card-img-top post-img mb-2" alt="Post Image" />
          <h5 class="card-title">My Cute Puppy</h5>
          <p class="card-text">Saw this adorable pup at the park today üê∂!</p>
          <div class="d-flex justify-content-between align-items-center mt-3">
            <button class="btn like-btn" onclick="increaseLike(this)">
              ‚ù§Ô∏è <span class="like-count">0</span> Likes
            </button>
            <div>
              <button class="btn icon-btn" type="submit" title="Edit">
                <img width="32" height="32" src="https://img.icons8.com/sf-black-filled/64/F25081/create-new.png"
                  alt="create-new" />
              </button>
              <button class="btn icon-btn" title="Delete">
                <img width="30" height="30" src="https://img.icons8.com/ios-glyphs/30/F25081/filled-trash.png"
                  alt="filled-trash" />
              </button>
            </div>
          </div>
        </div>

        <!-- Static Post 2 -->
        <div class="card post-card p-3 mb-4">
          <h5 class="card-title">Lazy Cat Chronicles</h5>
          <p class="card-text">My cat just slept 16 hours straight üò¥üê±</p>
          <div class="d-flex justify-content-between align-items-center mt-3">
            <button class="btn like-btn" onclick="increaseLike(this)">
              ‚ù§Ô∏è <span class="like-count">0</span> Likes
            </button>
            <div>
              <button class="btn icon-btn" title="Edit">
                <img width="32" height="32" src="https://img.icons8.com/sf-black-filled/64/F25081/create-new.png"
                  alt="create-new" />
              </button>
              <button class="btn icon-btn" title="Delete">
                <img width="30" height="30" src="https://img.icons8.com/ios-glyphs/30/F25081/filled-trash.png"
                  alt="filled-trash" />
              </button>
            </div>
          </div>
        </div>

        <!-- Dynamic Posts -->
        <% if (posts && posts.length !== 0) { %>
          <% posts.forEach(post=> { %>
            <div class="card post-card p-3 mb-4">
              <% if (post.image) { %> 
                <img src="<%= post.image %>" class="card-img-top post-img mb-2" alt="Post Image" />
                <% } %>
                  <div>
                    <h5 class="card-title mb-1">
                      <%= post.title %>
                    </h5>
                    <p class="text-muted mb-2" style="font-size: 0.9rem;">
                      <%= post.date %>
                    </p>

                    <p class="card-text">
                      <%= post.content %>
                    </p>
                  </div>
                  <div class="d-flex justify-content-between align-items-center mt-3">
                    <form action="/like/<%= post.id %>" method="POST">
                      <button class="btn like-btn" type="submit" <%=likedPostIds.includes(post.id) ? 'disabled' : '' %>>
                        ‚ù§Ô∏è <%= post.like_count %> Likes 
                      </button>
                    </form>
                  
                    <div class="d-flex gap-2">
                      <form action="/edit/<%= post.id %>" method="GET">
                        <button class="btn icon-btn" type="submit" title="Edit">
                          <img width="32" height="32"
                            src="https://img.icons8.com/sf-black-filled/64/F25081/create-new.png" alt="create-new" />
                        </button>
                      </form>
                      <form action="/delete/<%= post.id %>" method="POST"
                        onsubmit="return confirm('Are you sure you want to delete this post?');">
                        <button class="btn icon-btn" type="submit" title="Delete">
                          <img width="30" height="30" src="https://img.icons8.com/ios-glyphs/30/F25081/filled-trash.png"
                            alt="filled-trash" />
                        </button>
                      </form>
                    </div>
                  </div>
            </div>
            <% }) %>
              <% } %>
      </div>

      <!-- Right Column: About + Form -->
      <div class="col-md-4">
        <!-- About Me Card -->
        <div class="card about-card p-3 mb-4">
          <h5 class="card-title">About Me</h5>
          <p class="card-text">
            I‚Äôm an animal lover who created this blog to share cute moments,
            helpful tips, and connect with fellow pet lovers!
          </p>
        </div>

        <!-- New Post Form -->
        <form class="card post-form p-3" action="/add-post" method="POST" enctype="multipart/form-data">
          <h5 class="card-title">
            Got something interesting? Write here...ü©∑
          </h5>
          <input class="form-control mb-2" type="text" name="title" placeholder="Post title" required />
          <textarea class="form-control mb-2" name="content" placeholder="Write something cute..." rows="3"
            required></textarea>
          <input class="form-control mb-2" type="file" name="image" accept="image/*" />
          <button class="btn post-btn w-100" type="submit">Post</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <p>&copy; 2025 Pet Blog. All rights reserved.</p>
  </div>
  <script src="/js/script.js"></script>
</body>

</html>